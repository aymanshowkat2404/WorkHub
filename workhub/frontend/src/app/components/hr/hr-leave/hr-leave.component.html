<div class="main-content">
    <div class="header">
      <h1>Leave & Attendance Management</h1>
      <div class="header-actions">
        <button class="notification-btn">
          <i class="fas fa-bell"></i>
          <span class="notification-badge">3</span>
        </button>
        <button class="mobile-menu-btn">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  
    <div class="tabs">
      <div class="tab" [class.active]="activeTab === 'attendance'" (click)="setActiveTab('attendance')">Attendance</div>
      <div class="tab" [class.active]="activeTab === 'leave'" (click)="setActiveTab('leave')">Leave</div>
    </div>
  
    <!-- Attendance Tab Content -->
    <div class="tab-content" [class.active]="activeTab === 'attendance'">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Attendance Records</div>
          <div class="view-options">
            <button class="btn btn-sm" [class.btn-primary]="attendanceView === 'daily'" (click)="setAttendanceView('daily')">Daily</button>
            <button class="btn btn-sm" [class.btn-primary]="attendanceView === 'monthly'" (click)="setAttendanceView('monthly')">Monthly</button>
          </div>
        </div>
        
        <div *ngIf="attendanceView === 'daily'" class="section">
          <div class="filter-controls">
            <input type="date" class="form-control" [(ngModel)]="selectedDate">
            <button class="btn btn-primary btn-sm" (click)="loadAttendanceRecords()">Load</button>
          </div>
          
          <div class="table-responsive">
            <table class="records-table">
              <thead>
                <tr>
                  <th>Employee</th>
                  <th>Check In</th>
                  <th>Check Out</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let record of attendanceRecords">
                  <td>{{record.employeeName}}</td>
                  <td>{{record.checkIn | date:'shortTime'}}</td>
                  <td>{{record.checkOut | date:'shortTime'}}</td>
                  <td>
                    <span class="badge" [ngClass]="{
                      'badge-success': record.status === 'Present',
                      'badge-danger': record.status === 'Absent',
                      'badge-warning': record.status === 'Late' || record.status === 'Pending'
                    }">
                      {{record.status}}
                    </span>
                  </td>
                  <td>
                    <button *ngIf="record.status === 'Pending'" class="btn btn-success btn-sm" (click)="approveRegularization(record.id)">Approve</button>
                    <button *ngIf="record.status === 'Pending'" class="btn btn-danger btn-sm" (click)="rejectRegularization(record.id)">Reject</button>
                    <button class="btn btn-info btn-sm" (click)="editAttendance(record.id)">Edit</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
  
        <div *ngIf="attendanceView === 'monthly'" class="section">
          <div class="filter-controls">
            <input type="month" class="form-control" [(ngModel)]="selectedMonth">
            <button class="btn btn-primary btn-sm" (click)="loadMonthlyAttendance()">Load</button>
          </div>
          
          <div class="stats-grid">
            <div class="stat-card" *ngFor="let summary of monthlySummary">
              <div class="stat-icon icon-present">
                <i class="fas fa-user-check"></i>
              </div>
              <div class="stat-number">{{summary.employeeName}}</div>
              <div class="stat-details">
                <div class="stat-item">
                  <span class="stat-label">Present:</span>
                  <span class="stat-value">{{summary.present}}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Absent:</span>
                  <span class="stat-value">{{summary.absent}}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Late:</span>
                  <span class="stat-value">{{summary.late}}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Early Out:</span>
                  <span class="stat-value">{{summary.earlyOut}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="card">
        <div class="card-header">
          <div class="card-title">Mark Attendance (Manual)</div>
        </div>
        <div class="form-container">
          <div class="form-group">
            <label>Employee</label>
            <select class="form-control" [(ngModel)]="manualAttendance.employeeId">
              <option *ngFor="let emp of employees" [value]="emp.id">{{emp.name}}</option>
            </select>
          </div>
          <div class="form-group">
            <label>Date</label>
            <input type="date" class="form-control" [(ngModel)]="manualAttendance.date">
          </div>
          <div class="form-group">
            <label>Check In</label>
            <input type="time" class="form-control" [(ngModel)]="manualAttendance.checkIn">
          </div>
          <div class="form-group">
            <label>Check Out</label>
            <input type="time" class="form-control" [(ngModel)]="manualAttendance.checkOut">
          </div>
          <div class="form-group">
            <label>Status</label>
            <select class="form-control" [(ngModel)]="manualAttendance.status">
              <option value="Present">Present</option>
              <option value="Absent">Absent</option>
              <option value="Late">Late</option>
              <option value="Half Day">Half Day</option>
            </select>
          </div>
          <button class="btn btn-primary" (click)="submitManualAttendance()">Submit</button>
        </div>
      </div>
  
      <div class="card">
        <div class="card-header">
          <div class="card-title">Attendance Settings</div>
        </div>
        <div class="settings-form">
          <div class="form-group">
            <label>Office Start Time</label>
            <input type="time" class="form-control" [(ngModel)]="attendanceSettings.startTime">
          </div>
          <div class="form-group">
            <label>Office End Time</label>
            <input type="time" class="form-control" [(ngModel)]="attendanceSettings.endTime">
          </div>
          <div class="form-group">
            <label>Grace Period (minutes)</label>
            <input type="number" class="form-control" [(ngModel)]="attendanceSettings.gracePeriod">
          </div>
          <div class="form-group">
            <label>Half Day Threshold (hours)</label>
            <input type="number" class="form-control" [(ngModel)]="attendanceSettings.halfDayThreshold">
          </div>
          <button class="btn btn-primary" (click)="saveAttendanceSettings()">Save Settings</button>
        </div>
      </div>
    </div>
  
    <!-- Leave Tab Content -->
    <div class="tab-content" [class.active]="activeTab === 'leave'">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Leave Requests</div>
          <div class="filter-controls">
            <select class="filter-control" [(ngModel)]="leaveFilterStatus" (change)="loadLeaveRequests()">
              <option value="All">All</option>
              <option value="Pending">Pending</option>
              <option value="Approved">Approved</option>
              <option value="Rejected">Rejected</option>
            </select>
          </div>
        </div>
        
        <div class="table-responsive">
          <table class="records-table">
            <thead>
              <tr>
                <th>Employee</th>
                <th>Leave Type</th>
                <th>From</th>
                <th>To</th>
                <th>Days</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let request of leaveRequests">
                <td>{{request.employeeName}}</td>
                <td>{{request.leaveType}}</td>
                <td>{{request.startDate | date}}</td>
                <td>{{request.endDate | date}}</td>
                <td>{{request.days}}</td>
                <td>
                  <span class="leave-status" [ngClass]="{
                    'status-pending': request.status === 'Pending',
                    'status-approved': request.status === 'Approved',
                    'status-rejected': request.status === 'Rejected'
                  }">
                    {{request.status}}
                  </span>
                </td>
                <td>
                  <button *ngIf="request.status === 'Pending'" class="btn btn-success btn-sm" (click)="approveLeave(request.id)">Approve</button>
                  <button *ngIf="request.status === 'Pending'" class="btn btn-danger btn-sm" (click)="rejectLeave(request.id)">Reject</button>
                  <button class="btn btn-info btn-sm" (click)="viewLeaveDetails(request.id)">View</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
  
      <div class="card">
        <div class="card-header">
          <div class="card-title">Leave Balance Overview</div>
        </div>
        <div class="leave-balance">
          <div class="balance-item" *ngFor="let balance of leaveBalances">
            <h3>{{balance.employeeName}}</h3>
            <div class="balance-details">
              <div class="balance-row">
                <span class="balance-label">Sick Leave:</span>
                <span class="balance-value">{{balance.sickLeave}}/{{balance.sickLeaveTotal}}</span>
              </div>
              <div class="balance-row">
                <span class="balance-label">Casual Leave:</span>
                <span class="balance-value">{{balance.casualLeave}}/{{balance.casualLeaveTotal}}</span>
              </div>
              <div class="balance-row">
                <span class="balance-label">Earned Leave:</span>
                <span class="balance-value">{{balance.earnedLeave}}/{{balance.earnedLeaveTotal}}</span>
              </div>
              <div class="balance-row">
                <span class="balance-label">Total Taken:</span>
                <span class="balance-value">{{balance.totalTaken}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="card">
        <div class="card-header">
          <div class="card-title">Leave Settings</div>
        </div>
        <div class="settings-form">
          <div class="form-group">
            <label>Sick Leave (days/year)</label>
            <input type="number" class="form-control" [(ngModel)]="leaveSettings.sickLeave">
          </div>
          <div class="form-group">
            <label>Casual Leave (days/year)</label>
            <input type="number" class="form-control" [(ngModel)]="leaveSettings.casualLeave">
          </div>
          <div class="form-group">
            <label>Earned Leave (days/year)</label>
            <input type="number" class="form-control" [(ngModel)]="leaveSettings.earnedLeave">
          </div>
          <div class="form-group">
            <label>Max Continuous Leave (days)</label>
            <input type="number" class="form-control" [(ngModel)]="leaveSettings.maxContinuous">
          </div>
          <div class="form-group">
            <label>Holidays (comma separated dates)</label>
            <textarea class="form-control" [(ngModel)]="leaveSettings.holidays"></textarea>
          </div>
          <button class="btn btn-primary" (click)="saveLeaveSettings()">Save Settings</button>
        </div>
      </div>
  
      <div class="card">
        <div class="card-header">
          <div class="card-title">Generate Reports</div>
        </div>
        <div class="report-controls">
          <div class="form-group">
            <label>Report Type</label>
            <select class="form-control" [(ngModel)]="reportType">
              <option value="LeaveSummary">Leave Summary</option>
              <option value="LeaveTrend">Leave Trend</option>
              <option value="AttendanceSummary">Attendance Summary</option>
            </select>
          </div>
          <div class="form-group">
            <label>From</label>
            <input type="date" class="form-control" [(ngModel)]="reportStartDate">
          </div>
          <div class="form-group">
            <label>To</label>
            <input type="date" class="form-control" [(ngModel)]="reportEndDate">
          </div>
          <button class="btn btn-primary" (click)="generateReport()">Generate Report</button>
        </div>
      </div>
    </div>
  </div>